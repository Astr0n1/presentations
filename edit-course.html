<!DOCTYPE html>
<html lang="ar" dir="rtl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Lessons - ุงูููุตุฉ ุงูุชุนููููุฉ</title>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>
		<link rel="stylesheet" href="css/styles.css" />
		<link rel="stylesheet" href="css/edit.css" />
		<link rel="stylesheet" href="css/mobile-nav.css" />

		<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Lateef&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Scheherazade&display=swap" rel="stylesheet">

		<link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css?v=1.09">

		<script src="https://cdn.tailwindcss.com"></script>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<script defer src="js/auth.js"></script>
		<script type="module" defer src="js/edit.js"></script>
</head>
	<!-- <body class="bg-gray-100 min-h-screen" onload="requireAdmin()"> -->

	<body class="bg-gray-100 min-h-screen">
		<!-- Resize Indicator -->
		<div id="resize-indicator" class="resize-indicator"></div>

		<!-- Header -->
		<header class="main-header bg-white border-b border-gray-200">
			<div class="flex items-center justify-between px-6 py-4">
				<div class="flex items-center space-x-4 space-x-reverse">
					<button class="p-2 rounded-lg hover:bg-gray-100">
						<i class="fas fa-arrow-right text-gray-600"></i>
					</button>
					<h1 class="text-xl font-bold text-gray-900">Lessons</h1>
				</div>
				<div class="flex items-center space-x-3 space-x-reverse">
					<button
						id="save-changes"
						class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium"
					>
						ุญูุธ ุงูุชุบููุฑุงุช
					</button>
					<button class="p-2 rounded-lg hover:bg-gray-100">
						<i class="fas fa-ellipsis-v text-gray-600"></i>
					</button>
				</div>
			</div>
		</header>

		<div class="flex">
			<!-- Edit Sidebar (Left) - REMOVE BUTTON FROM HERE -->
			<div class="edit-sidebar fixed left-0 top-0 h-full bg-white border-r border-gray-200 z-20 flex-shrink-0 min-w-[300px] max-w-[50vw] md:min-w-[300px] md:max-w-[50vw] sm:min-w-[40vw] sm:max-w-[100vw] transition-transform duration-300 ease-in-out">
					<!-- Resize Handle -->
					<div class="resize-handle resize-handle-right" id="resize-edit-sidebar"></div>

					<!-- Scrollable Content Container -->
					<div class="h-full overflow-y-auto">
							<div class="px-4 py-6">
									<div class="flex items-center justify-between mb-6">
											<h2 class="text-xl font-bold text-gray-900">ุชุนุฏูู ุงูุณูุงูุฏ</h2>
											<!-- <button id="toggle-edit-sidebar" class="p-2 rounded-lg hover:bg-gray-100">
													<i class="fas fa-chevron-left text-gray-600"></i>
											</button> -->
									</div>
									<div id="slide-edit-content">
											<div class="text-center text-gray-500 py-12">
													<i class="fas fa-edit text-4xl mb-4"></i>
													<p>ุงุฎุชุฑ ุณูุงูุฏุงู ููุชุนุฏูู</p>
											</div>
									</div>
							</div>
					</div>
			</div>

			<!-- Main Content -->
			<div class="main-content flex-1 p-6">
				<!-- Current Lesson Header -->
				<div class="bg-white rounded-xl shadow-sm px-6 py-4 mb-6">
					<div
						class="flex items-center justify-between mx-auto max-w-[min(100%,700px)]"
						dir="rtl"
					>

						<!-- Center: Lesson title + code -->
						<div
							id="lesson-title-display"
							class="flex items-center gap-3 text-right ml-auto mr-2"
						>
							<h2
								id="current-lesson-title"
								class="text-2xl font-bold text-gray-900"
							>
								ุงูุฏุฑุณ ุงูุฃูู
							</h2>
							<span
								id="current-lesson-code"
								class="text-gray-500 text-sm font-medium"
							>
							</span>
						</div>

						<!-- Left side: Edit button -->
						<button
							id="edit-lesson-title"
							class="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
							title="ุชุนุฏูู ุงุณู ุงูุฏุฑุณ"
						>
							<i class="fas fa-edit"></i>
						</button>
					</div>

					<!-- Edit Lesson Title Form (Hidden by default) -->
					<div
						id="edit-lesson-form"
						class="mt-4 p-4 bg-gray-50 rounded-lg hidden"
					>
						<div class="space-y-3">
							<div>
								<label
									class="block text-sm font-medium text-gray-700 mb-2"
									>ุงุณู ุงูุฏุฑุณ</label
								>
								<input
									type="text"
									id="lesson-title-input"
									class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
								/>
							</div>
							<div style="display:none;">
								<label
									class="block text-sm font-medium text-gray-700 mb-2"
									>ููุฏ ุงูุฏุฑุณ</label
								>
								<input
									type="text"
									id="lesson-code-input"
									class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
								/>
							</div>
							<div
								class="flex items-center space-x-3 space-x-reverse"
							>
								<button
									id="save-lesson-title"
									class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
								>
									ุญูุธ
								</button>
								<button
									id="cancel-lesson-edit"
									class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"
								>
									ุฅูุบุงุก
								</button>
							</div>
						</div>
					</div>
				</div>

				<!-- Replace the Slide Preview Area section with this: -->

				<!-- Slide Preview Area -->
				<div class="gap-8 overflow-hidden mb-6 flex justify-center items-center relative slide-nav-container">
						<!-- Previous Slide Button (Left side) -->
						<button
								id="next-slide-btn"
								class="slide-nav-btn bg-white text-gray-800 rounded-full w-12 h-12 flex items-center justify-center shadow-lg border border-gray-300 hover:border-gray-400 z-30"
								style="opacity: 1;"
						>
								<i class="fas fa-chevron-right text-xl"></i>
						</button>

						<!-- Slide Preview Container -->
						<div
								id="slide-preview-container"
								class="slide-preview rounded-t-xl fixed-slide-size m-0 flex items-center justify-center relative"
						>
								<!-- Preview content will be dynamically loaded here -->
								<div
										id="slide-preview-content"
										class="w-full h-full overflow-hidden transition-all duration-500 ease-in-out"
								>
										<div
												class="flex flex-col items-center justify-center text-center h-full text-white opacity-80"
										>
												<i class="fas fa-sliders-h text-6xl mb-6"></i>
												<h2 class="text-2xl font-bold mb-3">
														ุงุฎุชุฑ ุณูุงูุฏุงู ูููุนุงููุฉ
												</h2>
												<p class="text-lg">
														ุงููุฑ ุนูู ุฃู ุณูุงูุฏ ูุฑุคูุฉ ูุญุชูุงู ููุง
												</p>
										</div>
								</div>
						</div>

						<!-- Next Slide Button (Right side) -->
						<button
								id="prev-slide-btn"
								class="slide-nav-btn bg-white text-gray-800 rounded-full w-12 h-12 flex items-center justify-center shadow-lg border border-gray-300 hover:border-gray-400 z-30"
								style="opacity: 1;"
						>
								<i class="fas fa-chevron-left text-xl"></i>
						</button>
				</div>
			</div>

			<!-- Loader Modal -->
			<div id="loader-modal" class="fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-[9999] transition-opacity duration-300">
					<div class="text-center">
							<!-- Spinner -->
							<div class="loader-spinner w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"></div>
							
							<!-- Loading Text -->
							<h3 class="text-xl font-semibold text-gray-800 mb-2">ุฌุงุฑู ุชุญููู ุงููุญุชูู</h3>
							<p class="text-gray-600">ูุฑุฌู ุงูุงูุชุธุงุฑ...</p>
							
							<!-- Progress Bar (Optional) -->
							<div class="w-48 h-2 bg-gray-200 rounded-full mt-4 mx-auto overflow-hidden">
									<div class="loader-progress h-full bg-blue-600 rounded-full transition-all duration-300" style="width: 0%"></div>
							</div>
					</div>
			</div>

			<!-- Right Lessons Sidebar - REMOVE BUTTON FROM HERE -->
			<div class="sidebar fixed right-0 top-0 h-full bg-white border-l border-gray-200 z-10 flex-shrink-0 min-w-[300px] max-w-[50vw] md:min-w-[300px] md:max-w-[50vw] md:block transition-transform duration-300 ease-in-out">
					<!-- Resize Handle -->
					<div class="resize-handle resize-handle-left" id="resize-sidebar"></div>

					<!-- Scrollable Content Container -->
					<div class="h-full overflow-y-auto">
							<div class="px-4 py-6">
									<!-- Lessons List -->
									<div class="mb-6">
											<h3 class="text-lg font-semibold text-gray-900 mb-4">ูุงุฆูุฉ ุงูุฏุฑูุณ</h3>
											<div id="lessons-list" class="space-y-3">
													<!-- Lessons will be dynamically added here -->
											</div>
									</div>

									<!-- Add Lesson Button -->
									<button
											id="add-lesson-btn"
											class="w-full flex items-center justify-center space-x-2 space-x-reverse py-3 px-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors mb-6"
									>
											<i class="fas fa-plus"></i>
											<span>ุฅุถุงูุฉ ุฏุฑุณ ุฌุฏูุฏ</span>
									</button>
							</div>
					</div>
			</div>

			<!-- FLOATING COLLAPSE BUTTONS -->
			<button
					id="collapse-edit-sidebar"
					class="fixed left-4 top-1/2 transform -translate-y-1/2 bg-white border border-gray-300 rounded-full shadow hover:bg-blue-50 transition-all duration-300 z-50 w-8 h-8 flex items-center justify-center sidebar-toggle-btn"
					title="ุฅุฎูุงุก / ุฅุธูุงุฑ ูุงุฆูุฉ ุงูุชุนุฏูู"
			>
					<i class="fas fa-chevron-right text-gray-600 text-sm"></i>
			</button>

			<button
					id="collapse-lessons-sidebar"
					class="fixed right-4 top-1/2 transform -translate-y-1/2 bg-white border border-gray-300 rounded-full shadow hover:bg-blue-50 transition-all duration-300 z-50 w-8 h-8 items-center justify-center sidebar-toggle-btn md:flex hidden"
					title="ุฅุฎูุงุก / ุฅุธูุงุฑ ูุงุฆูุฉ ุงูุฏุฑูุณ"
			>
					<i class="fas fa-chevron-left text-gray-600 text-sm"></i>
			</button>

		<!-- Add Slide Modal -->
		<div
			id="add-slide-modal"
			class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
		>
			<div
				class="bg-white rounded-xl shadow-lg w-full max-w-4xl h-[70vh] flex flex-col"
			>
				<!-- Simple Modal Header -->
        <div class="flex items-center justify-between px-4 py-2 border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900">ุฅุถุงูุฉ ุณูุงูุฏ ุฌุฏูุฏ</h2>
            <div class="flex items-center space-x-3 space-x-reverse">
                <button
                    id="close-add-slide-modal"
                    class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
                >
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
        </div>

				<div class="flex flex-1 overflow-hidden">
					<div
						class="w-1/4 bg-gray-50 border-r border-gray-200 p-4 overflow-y-auto"
					>
						<nav id="slide-category-nav" class="space-y-2">
							<a
								href="#"
								class="slide-category-btn flex items-center space-x-3 space-x-reverse px-3 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-200"
								data-category="text"
							>
								<i class="fas fa-font w-5 text-center"></i>
								<span>ูุต</span>
							</a>
							<a
								href="#"
								class="slide-category-btn flex items-center space-x-3 space-x-reverse px-3 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-200"
								data-category="image"
							>
								<i class="fas fa-image w-5 text-center"></i>
								<span>ุตูุฑุฉ</span>
							</a>
							<a
								href="#"
								class="slide-category-btn flex items-center space-x-3 space-x-reverse px-3 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-200"
								data-category="video"
							>
								<i class="fas fa-video w-5 text-center"></i>
								<span>ููุฏูู</span>
							</a>
							<a
								href="#"
								class="slide-category-btn flex items-center space-x-3 space-x-reverse px-3 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-200"
								data-category="quiz"
							>
								<i
									class="fas fa-question-circle w-5 text-center"
								></i>
								<span>ุงุฎุชุจุงุฑ</span>
							</a>
						</nav>
					</div>

					<div
						id="slide-templates-container"
						class="flex-1 p-6 overflow-y-auto"
					></div>
				</div>
			</div>
		</div>

		<!-- Saved Assets Modal -->
<div id="saved-assets-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl shadow-lg w-full max-w-4xl h-[70vh] flex flex-col">
        <!-- Modal Header -->
        <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900">ุงูุฃุตูู ุงููุญููุธุฉ</h2>
            <div class="flex items-center space-x-3 space-x-reverse">
                <button
                    id="close-saved-assets-modal"
                    class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
                >
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
        </div>

        <!-- Modal Content -->
        <div class="flex flex-1 overflow-hidden">
            <!-- Upload Section -->
            <div class="w-1/4 bg-gray-50 border-l border-gray-200 p-4">
                <div class="space-y-4">
                    <button
                        id="upload-from-device"
                        class="w-full flex items-center justify-center space-x-2 space-x-reverse bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 transition duration-150"
                    >
                        <i class="fas fa-upload"></i>
                        <span>ุฑูุน ูู ุงูุฌูุงุฒ</span>
                    </button>
                    <div class="text-sm text-gray-600 text-center">
                        <p>ููููู ุฑูุน ุงูุตูุฑ ุฃู ุงูููุฏูููุงุช ูู ุฌูุงุฒู</p>
                    </div>
                </div>
            </div>

            <!-- Assets Grid -->
            <div class="flex-1 p-6 overflow-y-auto">
                <div id="assets-loading" class="text-center py-8 hidden">
                    <i class="fas fa-spinner fa-spin text-2xl text-blue-500 mb-2"></i>
                    <p>ุฌุงุฑู ุชุญููู ุงูุฃุตูู...</p>
                </div>
                
                <div id="assets-container" class="hidden">
                    <h3 id="assets-type-title" class="text-lg font-semibold mb-4 text-gray-800"></h3>
                    <div id="assets-grid" class="grid grid-cols-3 gap-4">
                        <!-- Assets will be dynamically loaded here -->
                    </div>
                </div>

                <div id="assets-empty" class="text-center py-8 hidden">
                    <i class="fas fa-folder-open text-4xl text-gray-400 mb-3"></i>
                    <p class="text-gray-500">ูุง ุชูุฌุฏ ุฃุตูู ูุญููุธุฉ</p>
                </div>
            </div>
        </div>

        <!-- Modal Footer -->
        <div class="border-t border-gray-200 px-6 py-4 bg-gray-50">
            <div class="flex items-center justify-between">
                <span id="selected-asset-info" class="text-sm text-gray-600 hidden">
                    <i class="fas fa-check-circle text-green-500 ml-2"></i>
                    <span>ุชู ุงุฎุชูุงุฑ ุนูุตุฑ</span>
                </span>
                <div class="flex space-x-3 space-x-reverse">
                    <button
                        id="cancel-assets-selection"
                        class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"
                    >
                        ุฅูุบุงุก
                    </button>
                    <button
                        id="confirm-asset-selection"
                        class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors hidden"
                    >
                        ุชุฃููุฏ ุงูุงุฎุชูุงุฑ
                    </button>
                </div>
            </div>
        </div>

        <!-- Hidden file input for upload -->
        <input 
            type="file" 
            id="file-upload-input" 
            class="hidden" 
            accept="image/*,video/*" 
            multiple
        />
    </div>
</div>

		<!-- fix the mobile bottom nav JS functionality -->
		<!-- ๐ Mobile Bottom Slide Navigator -->
		<div
			id="mobile-slide-nav"
			class="mobile-lessons-bar fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-lg md:hidden flex flex-col z-40 transition-transform duration-300 translate-y-0"
		>
			<!-- Collapse Handle -->
			<div
				id="mobile-lessons-handle"
				class="cursor-pointer bg-gray-100 py-2 flex items-center justify-center border-b border-gray-200"
			>
				<i class="fas fa-chevron-up text-gray-600 text-lg"></i>
			</div>
			<!-- Top: Lessons Tabs -->
			<div
				id="mobile-lessons-tabs"
				class="flex overflow-x-auto border-b border-gray-100 no-scrollbar"
			>
				<!-- dynamically rendered -->
			</div>

			<!-- Bottom: Slides Row -->
			<div class="relative flex items-center">
				<button
					id="mobile-slide-prev"
					class="nav-arrow-left absolute left-0 ml-1 z-10 bg-white rounded-full shadow p-2"
				>
					<i class="fas fa-chevron-left text-gray-600"></i>
				</button>

				<div
					id="mobile-slides-scroll"
					class="slides-scroll flex-1 overflow-x-auto flex space-x-2 py-3 px-10 justify-center no-scrollbar"
				>
					<!-- slides squares will render here -->
				</div>

				<button
					id="mobile-slide-next"
					class="nav-arrow-right absolute right-0 mr-1 z-10 bg-white rounded-full shadow p-2"
				>
					<i class="fas fa-chevron-right text-gray-600"></i>
				</button>
			</div>
		</div>
</body>
</html>